import{a as q,c as N,r as b,w as k,o as E,h as c,ag as Q,d as I,aF as j,B as A,N as O,O as P,v as V,g as $,V as z,x as M,ah as D,aD as H}from"./index.55ab12b1.js";const L={ratio:[String,Number]};function K(e,f){return q(()=>{const l=Number(e.ratio||(f!==void 0?f.value:void 0));return isNaN(l)!==!0&&l>0?{paddingBottom:`${100/l}%`}:null})}const U=16/9;var G=N({name:"QImg",props:{...L,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:U},placeholderSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:f,emit:l}){const B=b(e.initialRatio),m=K(e,B);let o;const i=[b(null),b(e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null)],d=b(0),g=b(!1),v=b(!1),F=q(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),C=q(()=>({width:e.width,height:e.height})),w=q(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition`),n=q(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));k(()=>a(),h);function a(){return e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null}function h(t){if(clearTimeout(o),v.value=!1,t===null){g.value=!1,i[0].value=null,i[1].value=null;return}g.value=!0,i[d.value].value=t}function x({target:t}){o!==null&&(clearTimeout(o),B.value=t.naturalHeight===0?.5:t.naturalWidth/t.naturalHeight,S(t,1))}function S(t,_){o===null||_===1e3||(t.complete===!0?s(t):o=setTimeout(()=>{S(t,_+1)},50))}function s(t){o!==null&&(d.value=d.value===1?0:1,i[d.value].value=null,g.value=!1,v.value=!1,l("load",t.currentSrc||t.src))}function r(t){clearTimeout(o),g.value=!1,v.value=!0,i[0].value=null,i[1].value=null,l("error",t)}function y(t,_){return c("div",{class:"q-img__container absolute-full",key:t},_)}function u(t){const _=i[t].value,T={key:"img_"+t,class:w.value,style:n.value,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,..._};return d.value===t?(T.class+=" q-img__image--waiting",Object.assign(T,{onLoad:x,onError:r})):T.class+=" q-img__image--loaded",y("img"+t,c("img",T))}function R(){return g.value!==!0?c("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},I(f[v.value===!0?"error":"default"])):c("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},f.loading!==void 0?f.loading():e.noSpinner===!0?void 0:[c(j,{color:e.spinnerColor,size:e.spinnerSize})])}return h(a()),E(()=>{clearTimeout(o),o=null}),()=>{const t=[];return m.value!==null&&t.push(c("div",{key:"filler",style:m.value})),v.value!==!0&&(i[0].value!==null&&t.push(u(0)),i[1].value!==null&&t.push(u(1))),t.push(c(Q,{name:"q-transition--fade"},R)),c("div",{class:F.value,style:C.value,role:"img","aria-label":e.alt},t)}}}),J=N({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validation-success","validation-error"],setup(e,{slots:f,emit:l}){const B=$(),m=b(null);let o=0;const i=[];function d(n){const a=[],h=typeof n=="boolean"?n:e.noErrorFocus!==!0,x=++o,S=(s,r)=>{l("validation-"+(s===!0?"success":"error"),r)};for(let s=0;s<i.length;s++){const r=i[s],y=r.validate();if(typeof y.then=="function")a.push(y.then(u=>({valid:u,comp:r}),u=>({valid:!1,comp:r,err:u})));else if(y!==!0){if(e.greedy===!1)return S(!1,r),h===!0&&typeof r.focus=="function"&&r.focus(),Promise.resolve(!1);a.push({valid:!1,comp:r})}}return a.length===0?(S(!0),Promise.resolve(!0)):Promise.all(a).then(s=>{const r=s.filter(t=>t.valid!==!0);if(r.length===0)return x===o&&S(!0),!0;const{valid:y,comp:u,err:R}=r[0];return x===o&&(R!==void 0&&console.error(R),S(!1,u),h===!0&&y!==!0&&typeof u.focus=="function"&&u.focus()),!1})}function g(){o++,i.forEach(n=>{typeof n.resetValidation=="function"&&n.resetValidation()})}function v(n){n!==void 0&&z(n);const a=o+1;d().then(h=>{a===o&&h===!0&&(e.onSubmit!==void 0?l("submit",n):n!==void 0&&n.target!==void 0&&typeof n.target.submit=="function"&&n.target.submit())})}function F(n){n!==void 0&&z(n),l("reset"),M(()=>{g(),e.autofocus===!0&&e.noResetFocus!==!0&&C()})}function C(){D(()=>{if(m.value===null)return;const n=m.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(m.value.querySelectorAll("[tabindex]"),a=>a.tabIndex>-1);n!=null&&n.focus({preventScroll:!0})})}A(H,{bindComponent(n){i.push(n)},unbindComponent(n){const a=i.indexOf(n);a>-1&&i.splice(a,1)}});let w=!1;return O(()=>{w=!0}),P(()=>{w===!0&&e.autofocus===!0&&C()}),V(()=>{e.autofocus===!0&&C()}),Object.assign(B.proxy,{validate:d,resetValidation:g,submit:v,reset:F,focus:C,getValidationComponents:()=>i}),()=>c("form",{class:"q-form",ref:m,onSubmit:v,onReset:F},I(f.default))}});export{G as Q,J as a};
